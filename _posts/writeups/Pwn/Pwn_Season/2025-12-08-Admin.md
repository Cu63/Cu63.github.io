---
title: "Admin"
date: 2025-12-08
tags: [pwn, writeup]  
categories: [Reverse]
tagline: ""
header:
  overlay_image: /assets/images/IMG_writeups/IMG_Pwn/IMG_Pwn_Season/Pwn_Season_logo.jpg
  overlay_filter: 0.5 
  overlay_color: "#fff"
  actions:
    - label: "Pwn Season"
      url: "https://pwn.spbctf.ru/tasks/pwn1_admin"
classes: half
layout: single
toc: true
toc_sticky: true
toc_label: "Оглавление"
---

Надо сделать переполнение переменной `username` в `bss` секции и стать админом.

- [ELF](https://pwn.spbctf.ru/files/overflow/admin/task)

![IMG](/assets/images/IMG_writeups/IMG_Pwn/IMG_Pwn_Season/IMG_Admin/1.png){: height="200" .align-center}

# Solution

Строк почти нет. Перейду к реверсу.

## Анализ `main`

```c
  int32_t main(int32_t argc, char** argv, char** envp)

      is_admin = 0
      printf(format: "Enter your name: ")
      __isoc99_scanf(format: "%s", &username)
      
      if (is_admin == 0)
          printf(format: "Welcome, %s!\n", &username)
      else
          printf(format: "Welcome back, admin!\nHere is your flag: %s\n", getenv(name: "FLAG"))
      
      return 0
```

`is_admin` и `username` хранятся в секцие `.bss`.

> `.bss` - это секция, содержащая неинициализированные глобальные и статические переменные.

При этом `username` лежит над `is_admin`:

![IMG](/assets/images/IMG_writeups/IMG_Pwn/IMG_Pwn_Season/IMG_Admin/2.png){: height="200" .align-center}

Посмотрю меcто обращения к `username`:

![IMG](/assets/images/IMG_writeups/IMG_Pwn/IMG_Pwn_Season/IMG_Admin/3.png){: height="200" .align-center}

Отлично. Запись в `username` идет через `scanf` прямо в `main`. Для того, чтобы получить доступ к флагу, нужно записать не нулевое значение в переменную `is_flag`.

## Создание пейлоада

Между этими значениями `0x4041a0 - 0x4040a0 = 256` байт расстояния. Значит для переполнения нужно ввести 256 любых символов и не нулевое значение в `is_admin`. 

Введу 257 рандомных символов:

![IMG](/assets/images/IMG_writeups/IMG_Pwn/IMG_Pwn_Season/IMG_Admin/4.png){: height="200" .align-center}

Отлично. Получу флаг:

![IMG](/assets/images/IMG_writeups/IMG_Pwn/IMG_Pwn_Season/IMG_Admin/5.png){: height="200" .align-center}

```
spbctf{this_is_simple_overflow}
```